<div class="flex items-center justify-center border-solid border-4 p-20 flex-col">
    <div>
        <h2>Editar Jogador</h2>
    </div>
    <div class="w-60 flex">
        <form action="/player" method="POST">
            <div class="flex flex-col">
                <label for="name">Nome</label>
                <input type="text" name="name" id="name" value="{{player.name}}" class="bg-slate-100 p-1" required><br>
            </div>

            <div class="flex flex-col">
                <label for="age">Idade</label>
                <input type="text" name="age" id="age" value="{{player.age}}" class="bg-slate-100 p-1" required><br>
            </div>

            <div class="flex flex-col">
                <label for="position">Posição</label>
                <!-- O segundo valor estará selecionado inicialmente -->
                <select name="position" id="position" class="bg-slate-100 p-1" required>
                    <option value="..." selected disabled>Selecione a posição</option>
                    <option value="Atacante">Atacante</option>
                    <option value="Meia">Meia</option>
                    <option value="Volante">Volante</option>
                    <option value="Zagueiro">Zagueiro</option>
                    <option value="Goleiro">Goleiro</option>
                </select><br>
            </div>
            
            <div class="flex flex-col">
                <label for="team">Time</label>
                <input type="text" name="team" id="team" value="{{player.team}}" class="bg-slate-100 p-1" required><br>

            </div>

            <div class="text-center">
                <button type="submit" class="p-2 bg-blue-400 rounded-md text-center">Cadastrar</button>
            </div>
        </form>

    </div>
</div>


<script>
    const form = document.getElementById('forms');

    form.addEventListener("submit", function(event) {

        // Obtém os valores dos campos dentro do evento de envio
        const id = document.getElementById('id').value;
        const name = document.getElementById('name').value;
        const age = document.getElementById('age').value;
        const position = document.getElementById('position').value;
        const team = document.getElementById('team').value;

        // Validação básica
        if (!id || !name || !age || !position || !team) {
            alert("Por favor, preencha todos os campos.");
            return;
        }

        // Monta os dados para envio
        const data = {
            id: id,
            name: name, 
            age: age, 
            position: position, 
            team: team
        };

        console.log('dados para enviar:', data);  // Exibe os dados no console para verificação

        // Realiza a requisição PUT
        fetch(`/player/${id}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)  // Envia os dados no formato JSON
        })
        .then((response) => {
            if (!response.ok) {
                throw new Error('Erro na requisição');
            }
            return response.json();
        })
        .then((data) => {
            console.log('Resposta do servidor:', data);  // Resposta do servidor
            window.location.href = "/players";
        })
        .catch((err) => {
            console.error('Erro na requisição:', err);
            alert('Ocorreu um erro ao tentar atualizar o jogador.');
        });
    });
</script>



{{!-- form.addEventListener('submit', function(e){
        
        async function update(id, data){
            fetch(`/player/${id}`, {
                method: 'PUT',
                body: JSON.stringify({
                    data
                })
            }).then((response) => {
                    response.json().then((response) => {
                    console.log(response);
                })
            }).catch(err => {
                console.error(err)
            })
        }
    }) --}}